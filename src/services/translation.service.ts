import { Injectable, signal } from '@angular/core';

type Language = 'en' | 'es';

const translations = {
  en: {
    // General & Nav
    retailFlow: 'Sophie POS-Control',
    dashboard: 'Dashboard',
    pos: 'Point of Sale',
    inventory: 'Inventory',
    cashControl: 'Cash Control',
    online: 'Online',
    // Auth
    welcomeBack: 'Welcome',
    whoIsSelling: 'Who is selling today?',
    enterName: 'Enter your name',
    login: 'Start Selling',
    logout: 'Logout',
    seller: 'Seller',
    selectUser: 'Select User',
    password: 'Password',
    enterPassword: 'Enter Password',
    invalidPassword: 'Invalid Password',
    back: 'Back',
    // Dashboard
    dashboardTitle: 'Dashboard',
    dashboardSubtitle: 'Real-time overview of your retail business.',
    totalRevenue: 'Total Revenue',
    weeklyRevenue: 'Weekly Revenue',
    transactions: 'Transactions',
    lowStockItems: 'Low Stock Items',
    registerStatus: 'Register Status',
    open: 'Open',
    closed: 'Closed',
    stockAlerts: 'Stock Alerts',
    below5Units: 'Below 5 Units',
    product: 'Product',
    variant: 'Variant',
    sku: 'SKU',
    remaining: 'Remaining',
    stockHealthy: 'All stock levels are healthy!',
    downloadWeeklyReport: 'Download Weekly Report',
    // POS
    registerClosed: 'Register Closed',
    mustOpenShift: 'You must open a new cash shift before processing sales.',
    goToCashControl: 'Go to Cash Control',
    searchPlaceholder: 'Search product, SKU or barcode...',
    scan: 'Scan',
    cameraActive: 'Camera Active (Simulated)',
    simBarcode: 'Sim. Barcode',
    close: 'Close',
    noProductsMatch: 'No products match your search.',
    currentSale: 'Current Sale',
    clear: 'Clear',
    cartEmpty: 'Cart is empty',
    cartEmptySub: 'Scan items or click to add',
    subtotal: 'Subtotal',
    total: 'Total',
    cash: 'Cash',
    card: 'Card',
    // Inventory
    inventoryTitle: 'Inventory',
    scanOrSearch: 'Scan barcode or search...',
    addProduct: 'Add Product',
    variants: 'Variants',
    totalStock: 'Total Stock',
    actions: 'Actions',
    units: 'units',
    edit: 'Edit',
    noProductsFound: 'No products found.',
    newProductMatrix: 'New Product Matrix',
    cancel: 'Cancel',
    saveProduct: 'Save Product',
    productName: 'Product Name',
    basePrice: 'Base Price',
    description: 'Description',
    generateWithAi: 'Generate with AI',
    writing: 'Writing...',
    attributesAndVariants: 'Attributes & Variants',
    attrNamePlaceholder: 'Name (e.g. Size)',
    attrValuesPlaceholder: 'Values (comma separated)',
    addAttribute: 'Add Attribute',
    variantsPreview: 'Variants Preview',
    priceOverride: 'Price Override',
    initialStock: 'Initial Stock',
    auto: 'Auto',
    // Cash Control & Expenses
    cashControlTitle: 'Cash Control',
    cashControlSubtitle: 'Manage daily shifts, expenses, and cash flow.',
    currentStatus: 'Current Status',
    shiftOpen: 'SHIFT OPEN',
    shiftClosed: 'SHIFT CLOSED',
    startNewShift: 'Start New Shift',
    startShiftInstruction: 'Enter the amount of cash physically present in the drawer to begin selling.',
    openingCash: 'Opening Cash Amount',
    openRegister: 'Open Register',
    shiftInfo: 'Shift Information',
    openedAt: 'Opened At',
    startCash: 'Start Cash',
    expectedCash: 'Expected Cash',
    blindCount: 'Blind Count: Count the physical cash in the drawer before entering the amount below.',
    closeShift: 'Close Shift',
    actualCashCounted: 'Actual Cash Counted',
    difference: 'Difference',
    closeAndPrint: 'Close Shift & Print Report',
    shiftHistory: 'Shift History',
    date: 'Date',
    status: 'Status',
    expected: 'Expected',
    actual: 'Actual',
    diff: 'Diff',
    // Expenses & Sales Details
    expenses: 'Expenses',
    sales: 'Sales',
    addExpense: 'Add Expense',
    amount: 'Amount',
    category: 'Category',
    saveExpense: 'Save Expense',
    catSupplies: 'Supplies',
    catFood: 'Food',
    catServices: 'Services',
    catOther: 'Other',
    noExpenses: 'No expenses recorded for this shift.',
    noSales: 'No sales recorded for this shift.',
    expenseAdded: 'Expense added successfully.',
    totalExpenses: 'Total Expenses',
    totalSales: 'Total Sales',
    confirmDeleteExpense: 'Are you sure you want to delete this expense? The amount will be returned to the expected cash.',
    delete: 'Delete',
    items: 'items',
  },
  es: {
    // General & Nav
    retailFlow: 'Sophie POS-Control',
    dashboard: 'Panel',
    pos: 'Punto de Venta',
    inventory: 'Inventario',
    cashControl: 'Control de Caja',
    online: 'En Línea',
    // Auth
    welcomeBack: 'Bienvenido',
    whoIsSelling: '¿Quién va a vender hoy?',
    enterName: 'Ingresa tu nombre',
    login: 'Ingresar',
    logout: 'Salir',
    seller: 'Vendedor',
    selectUser: 'Seleccionar Usuario',
    password: 'Contraseña',
    enterPassword: 'Ingrese Contraseña',
    invalidPassword: 'Contraseña Incorrecta',
    back: 'Atrás',
    // Dashboard
    dashboardTitle: 'Panel de Control',
    dashboardSubtitle: 'Vista general en tiempo real de su negocio.',
    totalRevenue: 'Ingresos Totales',
    weeklyRevenue: 'Ingresos Semanales',
    transactions: 'Transacciones',
    lowStockItems: 'Items con Poco Stock',
    registerStatus: 'Estado de la Caja',
    open: 'Abierta',
    closed: 'Cerrada',
    stockAlerts: 'Alertas de Stock',
    below5Units: 'Menos de 5 unidades',
    product: 'Producto',
    variant: 'Variante',
    sku: 'SKU',
    remaining: 'Restante',
    stockHealthy: '¡Todos los niveles de stock están bien!',
    downloadWeeklyReport: 'Descargar Reporte Semanal',
    // POS
    registerClosed: 'Caja Cerrada',
    mustOpenShift: 'Debe abrir un nuevo turno de caja antes de procesar ventas.',
    goToCashControl: 'Ir a Control de Caja',
    searchPlaceholder: 'Buscar producto, SKU o código de barras...',
    scan: 'Escanear',
    cameraActive: 'Cámara Activa (Simulado)',
    simBarcode: 'Sim. Código',
    close: 'Cerrar',
    noProductsMatch: 'No hay productos que coincidan con su búsqueda.',
    currentSale: 'Venta Actual',
    clear: 'Limpiar',
    cartEmpty: 'El carrito está vacío',
    cartEmptySub: 'Escanee artículos o haga clic para agregar',
    subtotal: 'Subtotal',
    total: 'Total',
    cash: 'Efectivo',
    card: 'Tarjeta/ Yape',
    // Inventory
    inventoryTitle: 'Inventario',
    scanOrSearch: 'Escanear código o buscar...',
    addProduct: 'Añadir Producto',
    variants: 'Variantes',
    totalStock: 'Stock Total',
    actions: 'Acciones',
    units: 'unidades',
    edit: 'Editar',
    noProductsFound: 'No se encontraron productos.',
    newProductMatrix: 'Nueva Matriz de Producto',
    cancel: 'Cancelar',
    saveProduct: 'Guardar Producto',
    productName: 'Nombre del Producto',
    basePrice: 'Precio Base',
    description: 'Descripción',
    generateWithAi: 'Generar con IA',
    writing: 'Escribiendo...',
    attributesAndVariants: 'Atributos y Variantes',
    attrNamePlaceholder: 'Nombre (ej. Talla)',
    attrValuesPlaceholder: 'Valores (separados por coma)',
    addAttribute: 'Añadir Atributo',
    variantsPreview: 'Vista Previa de Variantes',
    priceOverride: 'Sobrescribir Precio',
    initialStock: 'Stock Inicial',
    auto: 'Auto',
    // Cash Control & Expenses
    cashControlTitle: 'Control de Caja',
    cashControlSubtitle: 'Gestionar turnos, gastos y flujo de efectivo.',
    currentStatus: 'Estado Actual',
    shiftOpen: 'TURNO ABIERTO',
    shiftClosed: 'TURNO CERRADO',
    startNewShift: 'Iniciar Nuevo Turno',
    startShiftInstruction: 'Ingrese la cantidad de efectivo físico en el cajón para comenzar a vender.',
    openingCash: 'Efectivo de Apertura',
    openRegister: 'Abrir Caja',
    shiftInfo: 'Información del Turno',
    openedAt: 'Abierto a las',
    startCash: 'Efectivo Inicial',
    expectedCash: 'Efectivo Esperado',
    blindCount: 'Conteo a Ciegas: Cuente el efectivo físico en el cajón antes de ingresar el monto a continuación.',
    closeShift: 'Cerrar Turno',
    actualCashCounted: 'Efectivo Real Contado',
    difference: 'Diferencia',
    closeAndPrint: 'Cerrar Turno e Imprimir Reporte',
    shiftHistory: 'Historial de Turnos',
    date: 'Fecha',
    status: 'Estado',
    expected: 'Esperado',
    actual: 'Real',
    diff: 'Dif',
    // Expenses & Sales Details
    expenses: 'Gastos',
    sales: 'Ventas',
    addExpense: 'Registrar Gasto',
    amount: 'Monto',
    category: 'Categoría',
    saveExpense: 'Guardar Gasto',
    catSupplies: 'Insumos',
    catFood: 'Alimentos',
    catServices: 'Servicios',
    catOther: 'Otros',
    noExpenses: 'No hay gastos registrados en este turno.',
    noSales: 'No hay ventas registradas en este turno.',
    expenseAdded: 'Gasto registrado correctamente.',
    totalExpenses: 'Total Gastos',
    totalSales: 'Total Ventas',
    confirmDeleteExpense: '¿Estás seguro de eliminar este gasto? El monto regresará al efectivo esperado.',
    delete: 'Eliminar',
    items: 'items',
  }
};

@Injectable({
  providedIn: 'root'
})
export class TranslationService {
  language = signal<Language>('es'); // Default to ES based on user request context

  setLanguage(lang: Language) {
    this.language.set(lang);
  }

  translate(key: string): string {
    const lang = this.language();
    const keyTyped = key as keyof typeof translations.en;
    return translations[lang][keyTyped] || key;
  }
}